---
description: 
globs: 
alwaysApply: true
---
# Lambda.hu √âp√≠t≈ëanyag AI Rendszer - Fejleszt√©si Backlog

## Minimum Credible Product (MCP) C√©lja
**C√©l:** Bemutatni a rendszer alapvet≈ë k√©pess√©g√©t: egy felhaszn√°l√≥ term√©szetes nyelven kereshet √©p√≠t≈ëanyagot, a rendszer pedig a naprak√©sz, "scraped" adatok alapj√°n relev√°ns term√©keket √©s AI-alap√∫ szak√©rt≈ëi v√°laszt ad.
- **Gy√°rt√≥k:** Csak 1 gy√°rt√≥ (Rockwool) adatainak teljes feldolgoz√°sa.
- **Funkci√≥k:**
    - **Hibrid adatgy≈±jt√©s √©s feldolgoz√°s** (Rockwool): Hagyom√°nyos scraper + **üöÄ BrightData MCP AI** (48 tools, CAPTCHA solving)
    - Struktur√°lt adatb√°zis (PostgreSQL) √©s vektor adatb√°zis (Chroma).
    - Term√©szetes nyelv≈± keres√©s (RAG pipeline) √©s egyszer≈±, sz≈±r≈ë n√©lk√ºli term√©klista.
    - Egyszer≈±s√≠tett UI: egy keres≈ëmez≈ë, egy AI chat ablak √©s egy term√©klista megjelen√≠t≈ë.
- **Nem r√©sze az MCP-nek:** T√∂bb gy√°rt√≥, aj√°nlatk√©sz√≠t≈ë modul, komplex sz≈±r≈ëk, felhaszn√°l√≥i fi√≥kok.

---

## Teljes Projekt F√°zisok √©s Feladatok

### F√°zis 1: Alapoz√°s √©s Infrastrukt√∫ra (H√©t 1-2) ‚úÖ INFRASTRUCTURE READY
- [x] **Projektstrukt√∫ra fel√°ll√≠t√°sa** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Directory structure exists, basic files created
  - **Tested**: File organization, folder structure
  - **Requires**: Human verification that structure meets requirements
  
- [x] **Docker-compose konfigur√°ci√≥** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: docker-compose.yml exists with FastAPI, PostgreSQL, Redis services
  - **Tested**: File syntax validation, service definitions
  - **Requires**: Human verification with `docker-compose up` and actual service connectivity
  
- [x] **Adatb√°zis s√©m√°k √©s SQLAlchemy modellek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Models exist for manufacturers, categories, products
  - **Tested**: Model definitions, basic imports work
  - **Requires**: Human verification with real database connection and data operations
  
- [x] **Alapvet≈ë FastAPI alkalmaz√°s** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: FastAPI app starts, basic endpoints exist, CORS configured
  - **Tested**: Server starts without errors, basic health endpoint
  - **Requires**: Human verification with real database operations and API testing
  
- [x] **Alapvet≈ë Next.js/React frontend v√°z** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Frontend project created, Tailwind CSS configured, basic components
  - **Tested**: Development server starts, basic page rendering
  - **Requires**: Human verification of UI functionality and API integration

### F√°zis 2: Adat-pipeline √©s Web Scraping (H√©t 2-4) ‚úÖ MIXED STATUS

#### **Rockwool Scraper Rendszer**
- [x] **Weboldal strukt√∫ra elemz√©se √©s t√©rk√©pez√©se** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: HTML structure analysis completed, page mapping documented
  - **Tested**: Basic page structure identification, URL pattern recognition
  - **Requires**: Human verification with live website interaction

- [x] **Term√©k adatok automatikus kinyer√©se** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Scraping functions exist for name, description, technical parameters
  - **Tested**: Sample data extraction from test pages
  - **Requires**: Human verification with full product catalog scraping

- [x] **K√©pek √©s dokumentumok let√∂lt√©se** ‚ùå INFRASTRUCTURE ONLY - NOT COMPLETE
  - **Evidence**: PDF URL extraction functions exist, download logic implemented
  - **Tested**: Sample PDF downloads (2-3 files), basic file validation
  - **Requires**: Human verification with all 40+ PDFs from live website
  - **Critical Issue**: Full implementation was interrupted, only infrastructure exists

- [x] **Rate limiting √©s hibakezel√©s** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Error handling code exists, rate limiting logic implemented
  - **Tested**: Basic error scenarios, timeout handling
  - **Requires**: Human verification under production load conditions

- [x] **Modul√°ris scraper architekt√∫ra** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: RockwoolScraper, ProductParser, CategoryMapper, DataValidator classes exist
  - **Tested**: Class instantiation, basic method calls
  - **Requires**: Human verification of full scraping workflow

- [x] **REST API v√©gpontok scraper kezel√©s√©re** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: API endpoints exist, basic routing configured
  - **Tested**: Endpoint accessibility, basic parameter validation
  - **Requires**: Human verification with real scraping operations

- [x] **Dokument√°ci√≥ √©s tesztel√©si eszk√∂z√∂k** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Documentation files exist, basic test structure created
  - **Tested**: Documentation readability, test framework setup
  - **Requires**: Human verification of documentation completeness and test coverage

#### **BrightData MCP AI Scraping Rendszer**
- [x] **48 BrightData tool integr√°ci√≥** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: MCP tools configured, Claude AI integration exists
  - **Tested**: Basic tool connectivity, sample API calls
  - **Requires**: Human verification with production scraping scenarios

- [x] **Univerz√°lis scraping rendszer** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: CAPTCHA solving capability, anti-detection measures implemented
  - **Tested**: Basic anti-detection functionality, sample CAPTCHA handling
  - **Requires**: Human verification with various target websites

- [x] **5 koordin√°lt scraping strat√©gia** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Strategy implementations exist (API_ONLY, MCP_ONLY, etc.)
  - **Tested**: Basic strategy switching, configuration validation
  - **Requires**: Human verification of strategy effectiveness in production

- [x] **Celery integr√°ci√≥** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Celery configuration exists, background task structure
  - **Tested**: Basic task queuing, worker connectivity
  - **Requires**: Human verification with real background scraping loads

- [x] **Dokument√°ci√≥ rendszer** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Documentation files exist (BRIGHTDATA_MCP_SETUP_DOCUMENTATION.md, etc.)
  - **Tested**: File existence, basic content validation
  - **Requires**: Human verification of documentation accuracy and completeness

#### **Adatb√°zis Integr√°ci√≥ Rendszer**
- [x] **DatabaseIntegration szolg√°ltat√°s** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: ScrapedProduct ‚Üí Product mapping logic exists
  - **Tested**: Basic model conversion, simple database operations
  - **Requires**: Human verification with large-scale data processing

- [x] **Gy√°rt√≥k √©s kateg√≥ri√°k automatikus kezel√©se** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: ensure_manufacturer, ensure_category functions with caching
  - **Tested**: Basic manufacturer/category creation, cache functionality
  - **Requires**: Human verification with real manufacturer data

- [x] **SKU gener√°l√°s rendszer** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: ROCK-{kateg√≥ria}-{URL_hash} format implementation
  - **Tested**: Basic SKU generation, duplicate detection
  - **Requires**: Human verification with full product catalog

- [x] **Bulk ment√©si m≈±veletek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Bulk insert logic, error handling for large datasets
  - **Tested**: Small batch operations, basic error recovery
  - **Requires**: Human verification with production-scale data volumes

- [x] **M≈±szaki specifik√°ci√≥k normaliz√°l√°sa** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Raw + processed data structure handling
  - **Tested**: Basic data normalization, sample technical specs
  - **Requires**: Human verification with full range of technical data

- [x] **API integr√°ci√≥ v√©gpontok** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: POST /api/scraper/scrape/single-product and /save-to-database endpoints
  - **Tested**: Basic endpoint functionality, parameter validation
  - **Requires**: Human verification with end-to-end API workflows

- [x] **DataValidator rendszer** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Data quality validation logic, consistency checks
  - **Tested**: Basic validation rules, sample data quality checks
  - **Requires**: Human verification with diverse data scenarios

- [x] **AI-enhanced adatvalid√°l√°s** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: BrightData MCP result integration, hybrid data source handling
  - **Tested**: Basic AI validation, sample confidence scoring
  - **Requires**: Human verification with AI validation accuracy

- [x] **Metaadat kezel√©s** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: scraper_type, ai_confidence, processing_time tracking
  - **Tested**: Basic metadata logging, tracking functionality
  - **Requires**: Human verification of metadata accuracy and completeness

#### **Celery Automatiz√°l√°s Rendszer**
- [x] **Celery alkalmaz√°s konfigur√°ci√≥** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Redis broker with 4 specialized queues configured
  - **Tested**: Basic queue setup, worker connectivity
  - **Requires**: Human verification with production queue loads

- [x] **√útemezett feladatok rendszer** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Beat scheduler with daily/weekly automation
  - **Tested**: Basic scheduling configuration, task registration
  - **Requires**: Human verification of scheduled execution reliability

- [x] **Scraping task implementations** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: scheduled_rockwool_scraping, weekly_full_scraping, scrape_specific_urls
  - **Tested**: Basic task execution, parameter handling
  - **Requires**: Human verification with production scraping schedules

- [x] **Database maintenance tasks** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: database_maintenance, backup_database_statistics, check_database_health
  - **Tested**: Basic maintenance operations, health checks
  - **Requires**: Human verification with production database operations

- [x] **Notification task system** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: send_daily_scraping_report, send_scraping_error_alert, monitor_scraper_health
  - **Tested**: Basic notification functionality, alert generation
  - **Requires**: Human verification of notification reliability and accuracy

- [x] **Docker integr√°ci√≥** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: celery_worker, celery_beat, celery_flower containers configured
  - **Tested**: Basic container startup, service connectivity
  - **Requires**: Human verification with production Docker deployment

- [x] **Worker be√°ll√≠t√°sok** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Optimized prefetch, retry logic, detailed logging
  - **Tested**: Basic worker configuration, logging output
  - **Requires**: Human verification of worker performance under load

#### **Integr√°ci√≥s Tesztel√©s**
- [x] **test_integration.py framework** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Test framework with 5 main areas structured
  - **Tested**: Basic test structure, test runner functionality
  - **Requires**: Human verification that all tests pass with real data

- [x] **Adatb√°zis kapcsolat tesztek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Connection tests, table count validation, health checks
  - **Tested**: Basic database connectivity, table existence
  - **Requires**: Human verification with production database scenarios

- [x] **Scraper m≈±k√∂d√©s tesztek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Website structure testing, category traversal, product scraping tests
  - **Tested**: Basic scraping functionality, sample data extraction
  - **Requires**: Human verification with complete website scraping

- [x] **Adatb√°zis integr√°ci√≥ tesztek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Individual + bulk save validations with Product/Manufacturer/Category objects
  - **Tested**: Basic save operations, object creation
  - **Requires**: Human verification with large-scale data integration

- [x] **API v√©gpont tesztek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Health check, website-structure, scraping endpoint tests
  - **Tested**: Basic endpoint responses, parameter validation
  - **Requires**: Human verification with complete API workflow testing

- [x] **Celery feladat tesztek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Worker connection, debug task, queue monitoring tests
  - **Tested**: Basic task execution, queue functionality
  - **Requires**: Human verification with production task loads

- [x] **Hibakezel√©s √©s retry tesztek** ‚úÖ INFRASTRUCTURE READY
  - **Evidence**: Rate limiting, timeout, exponential backoff testing
  - **Tested**: Basic error scenarios, retry mechanisms
  - **Requires**: Human verification under production error conditions

#### **Outstanding Issues Requiring Immediate Attention**
- [ ] **Leier scraper implement√°ci√≥ja** üîÑ PLANNED
- [ ] **Baumit scraper implement√°ci√≥ja** üîÑ PLANNED

### F√°zis 3: AI Modul - RAG Pipeline (H√©t 4-6) üîÑ PLANNED
- [ ] **Hibrid Chroma vektor adatb√°zis** inicializ√°l√°sa √©s perziszt√°l√°sa
  - [ ] Hagyom√°nyos scraped adatok vektoriz√°l√°sa
  - [ ] **üöÄ AI-enhanced term√©kle√≠r√°sok** indexel√©se BrightData MCP eredm√©nyekb≈ël
  - [ ] Magyar nyelvi embeddings optimaliz√°l√°s
- [ ] **LangChain integr√°ci√≥ tov√°bbfejlesztve** √©s `BuildingMaterialsAI` service l√©trehoz√°sa
  - [ ] **AI scraping context** integr√°l√°sa a RAG pipeline-ba
  - [ ] **Intelligent retrieval** - forr√°s preferenci√°k (API vs MCP AI)
  - [ ] **Real-time scraping capability** term√©szetes nyelv≈± k√©r√©sekre
- [ ] Term√©kadatok automatikus vektoriz√°l√°sa √©s indexel√©se (hibrid forr√°sok)
- [ ] Q&A l√°nc l√©trehoz√°sa a magyar nyelv≈±, √©p√≠t√©szeti szak√©rt≈ëi prompt-tal
- [ ] **üöÄ AI confidence score** alap√∫ term√©k rangsorol√°s √©s v√°laszmin≈ës√©g
- [ ] Kompatibilit√°s-ellen≈ërz≈ë logika alapjainak implement√°l√°sa (`check_system_compatibility`)

### F√°zis 4: Backend API √©s Frontend Integr√°ci√≥ (H√©t 6-9) üîÑ PLANNED
- [ ] **Hibrid term√©kkeres≈ë API** v√©gpont l√©trehoz√°sa (sz√∂veges keres√©s + sz≈±r√©s)
  - [ ] **üöÄ `/api/search/hybrid`** - Kombin√°lja hagyom√°nyos + AI eredm√©nyeket
  - [ ] **üöÄ `/api/scraping/intelligent`** - Real-time AI scraping k√©r√©sre
  - [ ] **üöÄ `/api/scraping/status`** - AI scraping feladatok monitoring
- [ ] **AI Chat API tov√°bbfejlesztve** (`get_product_recommendations`)
  - [ ] **üöÄ `/api/ai/analyze-product`** - Term√©k AI elemz√©s k√©r√©sre
  - [ ] BrightData MCP eredm√©nyek integr√°l√°sa v√°laszokba
- [ ] Kompatibilit√°s-ellen≈ërz≈ë API v√©gpont l√©trehoz√°sa (AI-enhanced)
- [ ] **Frontend: AI-enhanced term√©kkeres≈ë** interface fejleszt√©se
  - [ ] **üöÄ Real-time scraping status** indicator
  - [ ] **üöÄ AI confidence score** megjelen√≠t√©s term√©kekn√©l
  - [ ] **üöÄ "K√©rd el AI-t√≥l √∫j term√©keket"** funkci√≥
- [ ] Frontend: AI Chat komponens fejleszt√©se √©s bek√∂t√©se
- [ ] Frontend: Term√©k adatlap √©s √∂sszehasonl√≠t√≥ komponens fejleszt√©se
- [ ] **üöÄ Scraping admin panel** - strat√©gia v√°lt√°s, monitoring (fejleszt≈ëknek)

### F√°zis 5: Aj√°nlatk√©sz√≠t≈ë Modul (H√©t 9-11) üîÑ PLANNED
- [ ] `quotes` adatb√°zis t√°bla √©s SQLAlchemy modell
- [ ] `QuoteCalculator` service implement√°l√°sa (√°rkalkul√°ci√≥, vesztes√©gsz√°m√≠t√°s)
- [ ] Aj√°nlatk√©sz√≠t≈ë API v√©gpontok (l√©trehoz√°s, lek√©rdez√©s)
- [ ] PDF gener√°l√≥ modul integr√°l√°sa (ReportLab)
- [ ] Email k√ºld≈ë szolg√°ltat√°s integr√°ci√≥ja
- [ ] Frontend: Aj√°nlatk√©sz√≠t≈ë UI (kos√°r, v√©gleges√≠t√©s)

### F√°zis 6: Finaliz√°l√°s √©s Deployment (H√©t 12) üîÑ PLANNED
- [ ] Teljes k√∂r≈± API √©s frontend tesztel√©s (pytest, Jest/Playwright)
- [ ] `Dockerfile`-ok finomhangol√°sa √©les k√∂rnyezetre
- [ ] CI/CD pipeline alapjainak l√©trehoz√°sa (pl. GitHub Actions)
- [ ] R√©szletes dokument√°ci√≥ (API Swagger, README)
- [ ] Felhaszn√°l√≥i tesztel√©s √©s visszajelz√©sek feldolgoz√°sa

---

## üìä SUMMARY STATUS

### ‚úÖ INFRASTRUCTURE READY (Phase 1 & 2)
**Total: 43 components with infrastructure completed**
- All basic project structure and configuration
- All scraping system components (infrastructure level)
- All database integration components (infrastructure level)
- All automation and testing frameworks (infrastructure level)

### üîç AWAITING HUMAN VERIFICATION
**Critical Items Requiring Immediate Testing:**
1. **PDF Downloading System** - Known to be incomplete
2. **Complete Rockwool Scraping Workflow** - End-to-end verification needed
3. **BrightData MCP Integration** - Production testing required
4. **Database Integration** - Large-scale data processing verification
5. **Celery Automation** - Production scheduling verification

### ‚ùå VERIFIED INCOMPLETE
**No items currently verified as production-complete**

### üîÑ PLANNED (Phase 3+)
**23 components in planning/development phase**

---

## üö® CRITICAL INSIGHT

**The backlog analysis reveals that 100% of "completed" items are actually at INFRASTRUCTURE READY status.**

**No items have been verified as production-complete through human testing.**

This confirms our process analysis: **Infrastructure existence ‚â† Functional implementation**

**Next Steps:**
1. Human verification of critical components
2. Actual end-to-end testing with real data
3. Production readiness assessment
4. Proper completion marking only after verification