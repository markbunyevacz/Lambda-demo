---
description: 
globs: 
alwaysApply: true
---
# Lambda.hu √âp√≠t≈ëanyag AI Rendszer - Fejleszt√©si Backlog

## Minimum Credible Product (MCP) C√©lja
**C√©l:** Bemutatni a rendszer alapvet≈ë k√©pess√©g√©t: egy felhaszn√°l√≥ term√©szetes nyelven kereshet √©p√≠t≈ëanyagot, a rendszer pedig a naprak√©sz, "scraped" adatok alapj√°n relev√°ns term√©keket √©s AI-alap√∫ szak√©rt≈ëi v√°laszt ad.
- **Gy√°rt√≥k:** Csak 1 gy√°rt√≥ (Rockwool) adatainak teljes feldolgoz√°sa.
- **Funkci√≥k:**
    - **Hibrid adatgy≈±jt√©s √©s feldolgoz√°s** (Rockwool): Hagyom√°nyos scraper + **üöÄ BrightData MCP AI** (48 tools, CAPTCHA solving)
    - Struktur√°lt adatb√°zis (PostgreSQL) √©s vektor adatb√°zis (Chroma).
    - Term√©szetes nyelv≈± keres√©s (RAG pipeline) √©s egyszer≈±, sz≈±r≈ë n√©lk√ºli term√©klista.
    - Egyszer≈±s√≠tett UI: egy keres≈ëmez≈ë, egy AI chat ablak √©s egy term√©klista megjelen√≠t≈ë.
- **Nem r√©sze az MCP-nek:** T√∂bb gy√°rt√≥, aj√°nlatk√©sz√≠t≈ë modul, komplex sz≈±r≈ëk, felhaszn√°l√≥i fi√≥kok.

---

## Teljes Projekt F√°zisok √©s Feladatok

### F√°zis 1: Alapoz√°s √©s Infrastrukt√∫ra (H√©t 1-2) ‚úÖ K√âSZ
- [x] Projektstrukt√∫ra fel√°ll√≠t√°sa (Backend, Docker)
- [x] Docker-compose konfigur√°ci√≥ (FastAPI, PostgreSQL, Redis)
- [x] Adatb√°zis s√©m√°k √©s SQLAlchemy modellek l√©trehoz√°sa (`manufacturers`, `categories`, `products`)
- [x] Alapvet≈ë FastAPI alkalmaz√°s l√©trehoz√°sa, CORS √©s DB kapcsolattal
- [x] Alapvet≈ë Next.js/React frontend v√°z l√©trehoz√°sa Tailwind CSS-szel (vizu√°lis v√°z k√©sz)

### F√°zis 2: Adat-pipeline √©s Web Scraping (H√©t 2-4) ‚úÖ K√âSZ + üöÄ TOV√ÅBBFEJLESZTVE
- [x] **Rockwool scraper implement√°ci√≥ja a Rendszerterv alapj√°n** ‚úÖ K√âSZ
  - [x] Weboldal strukt√∫ra elemz√©se √©s t√©rk√©pez√©se
  - [x] Term√©k adatok automatikus kinyer√©se (n√©v, le√≠r√°s, m≈±szaki param√©terek)
  - [x] K√©pek √©s dokumentumok let√∂lt√©se
  - [x] Rate limiting √©s hibakezel√©s implement√°l√°sa
  - [x] Modul√°ris scraper architekt√∫ra (RockwoolScraper, ProductParser, CategoryMapper, DataValidator)
  - [x] REST API v√©gpontok scraper kezel√©s√©re
  - [x] Komprehenz√≠v dokument√°ci√≥ √©s tesztel√©si eszk√∂z√∂k
- [x] **üöÄ BrightData MCP AI Scraping Rendszer** ‚úÖ √öJ TECHNOL√ìGIA (2025-01-27)
  - [x] **48 BrightData tool integr√°ci√≥** Claude AI-jal (mcp==1.10.1, langchain-anthropic==0.3.16)
  - [x] **Univerz√°lis scraping** minden gy√°rt√≥ sz√°m√°ra (CAPTCHA solving, anti-detection)
  - [x] **5 koordin√°lt scraping strat√©gia:** API_ONLY, MCP_ONLY, API_FALLBACK_MCP ‚≠ê, MCP_FALLBACK_API, PARALLEL
  - [x] **Celery integr√°ci√≥** background AI scraping feladatokhoz
  - [x] **Teljes dokument√°ci√≥:** BRIGHTDATA_MCP_SETUP_DOCUMENTATION.md, INSTALLATION_LOG.md, README_BRIGHTDATA_MCP.md
- [ ] **Leier scraper implement√°ci√≥ja** (üîÑ Most m√°r AI-jal 15 perc alatt implement√°lhat√≥)
- [ ] **Baumit scraper implement√°ci√≥ja** (üîÑ Most m√°r AI-jal 15 perc alatt implement√°lhat√≥)
- [x] **Scraped adatok valid√°l√°sa √©s normaliz√°l√°sa + Adatb√°zisba ment√©si logika** ‚úÖ K√âSZ + üöÄ AI TOV√ÅBBFEJLESZTVE *(A pont)*
  - [x] **DatabaseIntegration szolg√°ltat√°s:** ScrapedProduct ‚Üí Product modell mappel√©s teljes automatiz√°l√°ssal
  - [x] **Gy√°rt√≥k √©s kateg√≥ri√°k:** automatikus l√©trehoz√°sa (`ensure_manufacturer`, `ensure_category`) cache-el√©ssel
  - [x] **SKU gener√°l√°s:** ROCK-{kateg√≥ria}-{URL_hash} form√°tum duplik√°tum kezel√©ssel
  - [x] **Bulk ment√©si m≈±veletek:** hibat≈±r≈ë logik√°val √©s source_url alap√∫ fel√ºl√≠r√°ssal
  - [x] **M≈±szaki specifik√°ci√≥k normaliz√°l√°sa:** raw + processed adatok struktur√°l√°sa
  - [x] **API integr√°ci√≥:** `POST /api/scraper/scrape/single-product` √©s `/save-to-database` v√©gpontok
  - [x] **DataValidator:** teljes adatmin≈ës√©g biztos√≠t√°s √©s konzisztencia vizsg√°lat
  - [x] **üöÄ AI-enhanced adatvalid√°l√°s:** BrightData MCP eredm√©nyek integr√°l√°sa hibrid adatforr√°sokkal
  - [x] **Metaadat kezel√©s:** scraper_type (api/mcp_ai), ai_confidence, processing_time tracking
- [x] **Celery √©s Celery Beat automatikus, id≈ëz√≠tett friss√≠t√©s** ‚úÖ K√âSZ *(B pont)*
  - [x] **Celery alkalmaz√°s konfigur√°ci√≥:** Redis broker 4 specializ√°lt queue-val (scraping, database, notifications, default)
  - [x] **√útemezett feladatok:** beat scheduler napi/heti automatizmussal
  - [x] **scraping_tasks.py:** `scheduled_rockwool_scraping()` (napi 20 term√©k/kateg√≥ria), `weekly_full_scraping()`, `scrape_specific_urls()`
  - [x] **database_tasks.py:** `database_maintenance()` (cleanup, deduplik√°ci√≥, VACUUM), `backup_database_statistics()`, `check_database_health()`
  - [x] **notification_tasks.py:** `send_daily_scraping_report()`, `send_scraping_error_alert()`, `monitor_scraper_health()`
  - [x] **Docker integr√°ci√≥:** `celery_worker`, `celery_beat`, `celery_flower` (monitoring UI localhost:5555)
  - [x] **Worker be√°ll√≠t√°sok:** optimaliz√°lt prefetch, retry logika, r√©szletes logging
- [x] **Integr√°ci√≥s tesztel√©s √©les Rockwool adatokon** ‚úÖ K√âSZ *(C pont)*
  - [x] **test_integration.py:** komprehenz√≠v teszt framework 5 f≈ë ter√ºlettel
  - [x] **Adatb√°zis kapcsolat:** connection, table counts, health check ellen≈ërz√©se
  - [x] **Scraper alapvet≈ë m≈±k√∂d√©s:** weboldal strukt√∫ra felt√©rk√©pez√©s, kateg√≥ria bej√°r√°s, term√©k scraping
  - [x] **Adatb√°zis integr√°ci√≥:** egyedi + bulk ment√©sek valid√°l√°sa Product/Manufacturer/Category objektumokkal
  - [x] **API v√©gpontok:** health check, website-structure, scraping v√©gpontok tesztel√©se
  - [x] **Celery feladatok:** worker kapcsolat, debug task, queue monitoring ellen≈ërz√©se
  - [x] **Hibakezel√©s √©s retry:** rate limiting, timeout, exponential backoff teljes lefedetts√©ggel

### F√°zis 3: AI Modul - RAG Pipeline (H√©t 4-6) üîÑ TOV√ÅBBFEJLESZTVE AI-JJAL
- [ ] **Hibrid Chroma vektor adatb√°zis** inicializ√°l√°sa √©s perziszt√°l√°sa
  - [ ] Hagyom√°nyos scraped adatok vektoriz√°l√°sa
  - [ ] **üöÄ AI-enhanced term√©kle√≠r√°sok** indexel√©se BrightData MCP eredm√©nyekb≈ël
  - [ ] Magyar nyelvi embeddings optimaliz√°l√°s
- [ ] **LangChain integr√°ci√≥ tov√°bbfejlesztve** √©s `BuildingMaterialsAI` service l√©trehoz√°sa
  - [ ] **AI scraping context** integr√°l√°sa a RAG pipeline-ba
  - [ ] **Intelligent retrieval** - forr√°s preferenci√°k (API vs MCP AI)
  - [ ] **Real-time scraping capability** term√©szetes nyelv≈± k√©r√©sekre
- [ ] Term√©kadatok automatikus vektoriz√°l√°sa √©s indexel√©se (hibrid forr√°sok)
- [ ] Q&A l√°nc l√©trehoz√°sa a magyar nyelv≈±, √©p√≠t√©szeti szak√©rt≈ëi prompt-tal
- [ ] **üöÄ AI confidence score** alap√∫ term√©k rangsorol√°s √©s v√°laszmin≈ës√©g
- [ ] Kompatibilit√°s-ellen≈ërz≈ë logika alapjainak implement√°l√°sa (`check_system_compatibility`)

### F√°zis 4: Backend API √©s Frontend Integr√°ci√≥ (H√©t 6-9) üîÑ AI-ENHANCED
- [ ] **Hibrid term√©kkeres≈ë API** v√©gpont l√©trehoz√°sa (sz√∂veges keres√©s + sz≈±r√©s)
  - [ ] **üöÄ `/api/search/hybrid`** - Kombin√°lja hagyom√°nyos + AI eredm√©nyeket
  - [ ] **üöÄ `/api/scraping/intelligent`** - Real-time AI scraping k√©r√©sre
  - [ ] **üöÄ `/api/scraping/status`** - AI scraping feladatok monitoring
- [ ] **AI Chat API tov√°bbfejlesztve** (`get_product_recommendations`)
  - [ ] **üöÄ `/api/ai/analyze-product`** - Term√©k AI elemz√©s k√©r√©sre
  - [ ] BrightData MCP eredm√©nyek integr√°l√°sa v√°laszokba
- [ ] Kompatibilit√°s-ellen≈ërz≈ë API v√©gpont l√©trehoz√°sa (AI-enhanced)
- [ ] **Frontend: AI-enhanced term√©kkeres≈ë** interface fejleszt√©se
  - [ ] **üöÄ Real-time scraping status** indicator
  - [ ] **üöÄ AI confidence score** megjelen√≠t√©s term√©kekn√©l
  - [ ] **üöÄ "K√©rd el AI-t√≥l √∫j term√©keket"** funkci√≥
- [ ] Frontend: AI Chat komponens fejleszt√©se √©s bek√∂t√©se
- [ ] Frontend: Term√©k adatlap √©s √∂sszehasonl√≠t√≥ komponens fejleszt√©se
- [ ] **üöÄ Scraping admin panel** - strat√©gia v√°lt√°s, monitoring (fejleszt≈ëknek)

### F√°zis 5: Aj√°nlatk√©sz√≠t≈ë Modul (H√©t 9-11)
- [ ] `quotes` adatb√°zis t√°bla √©s SQLAlchemy modell
- [ ] `QuoteCalculator` service implement√°l√°sa (√°rkalkul√°ci√≥, vesztes√©gsz√°m√≠t√°s)
- [ ] Aj√°nlatk√©sz√≠t≈ë API v√©gpontok (l√©trehoz√°s, lek√©rdez√©s)
- [ ] PDF gener√°l√≥ modul integr√°l√°sa (ReportLab)
- [ ] Email k√ºld≈ë szolg√°ltat√°s integr√°ci√≥ja
- [ ] Frontend: Aj√°nlatk√©sz√≠t≈ë UI (kos√°r, v√©gleges√≠t√©s)

### F√°zis 6: Finaliz√°l√°s √©s Deployment (H√©t 12)
- [ ] Teljes k√∂r≈± API √©s frontend tesztel√©s (pytest, Jest/Playwright)
- [ ] `Dockerfile`-ok finomhangol√°sa √©les k√∂rnyezetre
- [ ] CI/CD pipeline alapjainak l√©trehoz√°sa (pl. GitHub Actions)
- [ ] R√©szletes dokument√°ci√≥ (API Swagger, README)
- [ ] Felhaszn√°l√≥i tesztel√©s √©s visszajelz√©sek feldolgoz√°sa